startsWith('+7')) phoneInput.value='+7 ';
  let digits=phoneInput.value.replace(/\D/g,'').slice(1,11);
  let formatted='+7 ';
  if(digits.length>0) formatted+=digits.substring(0,3);
  if(digits.length>=4) formatted+=' '+digits.substring(3,6);
  if(digits.length>=7) formatted+=' '+digits.substring(6,8);
  if(digits.length>=9) formatted+=' '+digits.substring(8,10);
  phoneInput.value=formatted;
});

form.addEventListener('submit',async e=>{
  e.preventDefault();
  statusEl.className='status';
  const name=document.getElementById('name').value.trim();
  const make=document.getElementById('make').value.trim();
  const plate=document.getElementById('plate').value.trim();
  const phoneDigits=phoneInput.value.replace(/\D/g,''); // —Ü–∏—Ñ—Ä—ã –¥–ª—è WhatsApp

  if(phoneDigits.length!==11 || !phoneDigits.startsWith('7')){
    statusEl.textContent='‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä +7 XXX XXX XX XX';
    statusEl.className='status show err';
    return;
  }

  // WhatsApp —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É
  const waMessage=`–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, ${name}!\n–í—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –æ—Å–º–æ—Ç—Ä.\nüìç –ê–¥—Ä–µ—Å: ${OFFICE_ADDRESS}\nüöó –ê–≤—Ç–æ: ${make}, ${plate}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏: ${OFFICE_PHONE}\n–° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø–∏—Å–∏.\n–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ!`;
  const waUrl=`https://wa.me/${phoneDigits}?text=${encodeURIComponent(waMessage)}`;
  window.open(waUrl,'_blank');

  // Telegram –∑–∞–ø–∏—Å—å –¥–ª—è –≤–∞—Å —Å –Ω–æ–º–µ—Ä–æ–º –∫–ª–∏–µ–Ω—Ç–∞
  const tgText=`üö® –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å –Ω–∞ –æ—Å–º–æ—Ç—Ä üö®\n\nüë§ –ò–º—è: ${name}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞: +${phoneDigits}\nüöó –ú–∞—Ä–∫–∞ –∞–≤—Ç–æ: ${make}\nü™™ –ì–æ—Å. –Ω–æ–º–µ—Ä: ${plate}\nüìç –ê–¥—Ä–µ—Å: ${OFFICE_ADDRESS}`;
  const tgUrl=`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage?chat_id=${encodeURIComponent(TELEGRAM_CHAT_ID)}&parse_mode=HTML&text=${encodeURIComponent(tgText)}`;

  try{
    await fetch(tgUrl,{method:'GET',mode:'cors'});
    statusEl.textContent='‚úÖ –ó–∞–ø–∏—Å—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Telegram –∏ –æ—Ç–∫—Ä—ã—Ç WhatsApp';
    statusEl.className='status show ok';
  }catch{
    statusEl.textContent='‚ö†Ô∏è WhatsApp –æ—Ç–∫—Ä—ã—Ç. –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram';
    statusEl.className='status show err';
  }
});
</script>
</body>
</html>
